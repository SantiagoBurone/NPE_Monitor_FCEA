rm(list=ls())
gc()
directorio<-"C:\\Users\\msilva\\Documents\\Mathias\\Bases\\Bases\\FCEA\\Actividades actualizadas\\Nuevas para actualizar"
setwd(directorio)
library(plyr)
gen2012<-read.csv("g_actividades_de_una_gen_2012_conv.csv")
gen2013<-read.csv("g_actividades_de_una_gen_2013_conv.csv")
gen2014<-read.csv("g_actividades_de_una_gen_2014_conv.csv")
gen2015<-read.csv("g_actividades_de_una_gen_2015_conv.csv")
gen2016<-read.csv("g_actividades_de_una_gen_2016_conv.csv")
genactual2012<-read.csv("C:\\Users\\msilva\\Documents\\Mathias\\Bases\\Mesareasocial\\Mesareasocial\\Mesareasocial\\Consultas SGB\\Consultas\\CCEE\\g_genactual\\g_gen2012_conv.csv")
genactual2013<-read.csv("C:\\Users\\msilva\\Documents\\Mathias\\Bases\\Mesareasocial\\Mesareasocial\\Mesareasocial\\Consultas SGB\\Consultas\\CCEE\\g_genactual\\g_gen2013_conv.csv")
genactual2014<-read.csv("C:\\Users\\msilva\\Documents\\Mathias\\Bases\\Mesareasocial\\Mesareasocial\\Mesareasocial\\Consultas SGB\\Consultas\\CCEE\\g_genactual\\g_gen2014_conv.csv")
genactual2015<-read.csv("C:\\Users\\msilva\\Documents\\Mathias\\Bases\\Mesareasocial\\Mesareasocial\\Mesareasocial\\Consultas SGB\\Consultas\\CCEE\\g_genactual\\g_gen2015_conv.csv")
genactual2016<-read.csv("C:\\Users\\msilva\\Documents\\Mathias\\Bases\\Mesareasocial\\Mesareasocial\\Mesareasocial\\Consultas SGB\\Consultas\\CCEE\\g_genactual\\g_gen2016_conv.csv")
colnames(genactual2012)[2]<-"ci"
colnames(genactual2013)[2]<-"ci"
colnames(genactual2014)[2]<-"ci"
colnames(genactual2015)[2]<-"ci"
colnames(genactual2016)[2]<-"ci"
#Filtrado de bases de actividad segun consulta de g_genactual, identificador nombre#
gen2012<-join_all(list(gen2012,genactual2012[,c("ci","NOMBRE")]),by="ci")
gen2012<-gen2012[which(is.na(gen2012$NOMBRE)==F),]
gen2013<-join_all(list(gen2013,genactual2013[,c("ci","NOMBRE")]),by="ci")
gen2013<-gen2013[which(is.na(gen2013$NOMBRE)==F),]
gen2014<-join_all(list(gen2014,genactual2014[,c("ci","NOMBRE")]),by="ci")
gen2014<-gen2014[which(is.na(gen2014$NOMBRE)==F),]
gen2015<-join_all(list(gen2015,genactual2015[,c("ci","NOMBRE")]),by="ci")
gen2015<-gen2015[which(is.na(gen2015$NOMBRE)==F),]
gen2016<-join_all(list(gen2016,genactual2016[,c("ci","NOMBRE")]),by="ci")
gen2016<-gen2016[which(is.na(gen2016$NOMBRE)==F),]
#Gente que aparece con actividades previas a su gen de ingreso es que tenia ingreso en otra carrera de facultad antes de las del plan nuevo
gen2012$anio<-round(gen2012$fecha/10000)
gen2013$anio<-round(gen2013$fecha/10000)
gen2014$anio<-round(gen2014$fecha/10000)
gen2015$anio<-round(gen2015$fecha/10000)
gen2016$anio<-round(gen2016$fecha/10000)
#identificador primer aparicion de cedula
gen2012$ident1<-ifelse(duplicated(gen2012$ci)==F,1,0)
gen2013$ident1<-ifelse(duplicated(gen2013$ci)==F,1,0)
gen2014$ident1<-ifelse(duplicated(gen2014$ci)==F,1,0)
gen2015$ident1<-ifelse(duplicated(gen2015$ci)==F,1,0)
gen2016$ident1<-ifelse(duplicated(gen2016$ci)==F,1,0)
#identificador 2012 en adelante "puros"#
inscriptos<-read.csv("C:\\Users\\msilva\\Documents\\Mathias\\Bases\\Mesareasocial\\Mesareasocial\\Mesareasocial\\Consultas SGB\\Consultas\\CCEE\\g_inscriptos\\g_inscriptos_19570101_20160101_consulta1_conv.csv")
inscriptos$anio<-round(inscriptos$FECHA/10000)
##funcion para identificar por ci aquellos cuya primer inscripcion a carrera en facultad fue por plan 12 (sin considerar periodos de inactividad,i.e., gente que se fue y volvio)##
aux1<-function(x){
out1<-inscriptos[which(inscriptos$ESTCI==x),c("FECHA","CARR")]
if(11%in%out1[which(out1[,1]==min(out1[,1])),2] | 12%in%out1[which(out1[,1]==min(out1[,1])),2] | 14%in%out1[which(out1[,1]==min(out1[,1])),2]){
return(c(min(out1[,1]),out1[which(out1[,1]==min(out1[,1]) & out1[,2]%in%c(11,12,14)),2]))
}
else{
return(c(0,0))
}
}
#####demora unos 10 min esto#####
salida1<-alply(inscriptos$ESTCI,1,aux1,.progress="text")
#####
df.salida1<-do.call(rbind,salida1)
df.salida1[which(df.salida1[,2]>2000),c(2:4)]<-c(0,0,0)
df.salida1[which(df.salida1[,3]>2000),c(3:4)]<-c(0,0)
df.salida1[which(df.salida1[,4]>2000),4]<-0
inscriptos<-cbind.data.frame(inscriptos,df.salida1)
colnames(inscriptos)[9:12]<-c("primerainsc","carr1p12","carr2p12","carr3p12")
inscriptos$aniopinsc<-round(inscriptos$primerainsc/10000)
##Descriptivo: primeros ingresos a facultad a partir del nuevo plan, por anio
#table(inscriptos$aniopinsc)
#Identificador por carrera de p12 segun anio de primera inscripcion (se podria programar mejor, definiendo una funcion)
#Economistas ingresos puros
inscriptos[which(inscriptos$aniopinsc==2012),"ecopuro12"]<-ifelse((inscriptos[which(inscriptos$aniopinsc==2012),"carr1p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2012),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2012),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2012),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2012),"carr2p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2012),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2012),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2012),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2012),"carr3p12"]==12),1,0)
inscriptos[which(inscriptos$aniopinsc==2013),"ecopuro13"]<-ifelse((inscriptos[which(inscriptos$aniopinsc==2013),"carr1p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2013),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2013),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2013),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2013),"carr2p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2013),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2013),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2013),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2013),"carr3p12"]==12),1,0)
inscriptos[which(inscriptos$aniopinsc==2014),"ecopuro14"]<-ifelse((inscriptos[which(inscriptos$aniopinsc==2014),"carr1p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2014),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2014),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2014),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2014),"carr2p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2014),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2014),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2014),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2014),"carr3p12"]==12),1,0)
inscriptos[which(inscriptos$aniopinsc==2015),"ecopuro15"]<-ifelse((inscriptos[which(inscriptos$aniopinsc==2015),"carr1p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2015),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2015),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2015),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2015),"carr2p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2015),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2015),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2015),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2015),"carr3p12"]==12),1,0)
inscriptos[which(inscriptos$aniopinsc==2016),"ecopuro16"]<-ifelse((inscriptos[which(inscriptos$aniopinsc==2016),"carr1p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2016),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2016),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2016),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2016),"carr2p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2016),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2016),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2016),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2016),"carr3p12"]==12),1,0)

#Contadores ingresos puros
inscriptos[which(inscriptos$aniopinsc==2012),"contpuro12"]<-ifelse((inscriptos[which(inscriptos$aniopinsc==2012),"carr1p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2012),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2012),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2012),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2012),"carr2p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2012),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2012),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2012),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2012),"carr3p12"]==11),1,0)
inscriptos[which(inscriptos$aniopinsc==2013),"contpuro13"]<-ifelse((inscriptos[which(inscriptos$aniopinsc==2013),"carr1p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2013),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2013),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2013),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2013),"carr2p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2013),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2013),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2013),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2013),"carr3p12"]==11),1,0)
inscriptos[which(inscriptos$aniopinsc==2014),"contpuro14"]<-ifelse((inscriptos[which(inscriptos$aniopinsc==2014),"carr1p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2014),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2014),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2014),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2014),"carr2p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2014),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2014),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2014),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2014),"carr3p12"]==11),1,0)
inscriptos[which(inscriptos$aniopinsc==2015),"contpuro15"]<-ifelse((inscriptos[which(inscriptos$aniopinsc==2015),"carr1p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2015),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2015),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2015),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2015),"carr2p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2015),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2015),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2015),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2015),"carr3p12"]==11),1,0)
inscriptos[which(inscriptos$aniopinsc==2016),"contpuro15"]<-ifelse((inscriptos[which(inscriptos$aniopinsc==2016),"carr1p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2016),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2016),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2016),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2016),"carr2p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2016),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2016),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2016),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2016),"carr3p12"]==11),1,0)

#Admins ingresos puros
inscriptos[which(inscriptos$aniopinsc==2012),"admpuro12"]<-ifelse((inscriptos[which(inscriptos$aniopinsc==2012),"carr1p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2012),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2012),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2012),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2012),"carr2p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2012),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2012),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2012),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2012),"carr3p12"]==14),1,0)
inscriptos[which(inscriptos$aniopinsc==2013),"admpuro13"]<-ifelse((inscriptos[which(inscriptos$aniopinsc==2013),"carr1p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2013),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2013),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2013),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2013),"carr2p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2013),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2013),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2013),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2013),"carr3p12"]==14),1,0)
inscriptos[which(inscriptos$aniopinsc==2014),"admpuro14"]<-ifelse((inscriptos[which(inscriptos$aniopinsc==2014),"carr1p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2014),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2014),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2014),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2014),"carr2p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2014),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2014),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2014),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2014),"carr3p12"]==14),1,0)
inscriptos[which(inscriptos$aniopinsc==2015),"admpuro15"]<-ifelse((inscriptos[which(inscriptos$aniopinsc==2015),"carr1p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2015),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2015),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2015),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2015),"carr2p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2015),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2015),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2015),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2015),"carr3p12"]==14),1,0)
inscriptos[which(inscriptos$aniopinsc==2016),"admpuro15"]<-ifelse((inscriptos[which(inscriptos$aniopinsc==2016),"carr1p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2016),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2016),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2016),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2016),"carr2p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2016),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2016),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2016),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2016),"carr3p12"]==14),1,0)

#Economistas contadores
inscriptos[which(inscriptos$aniopinsc==2012),"ecocont12"]<-ifelse((inscriptos[which(inscriptos$aniopinsc==2012),"carr1p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2012),"carr2p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2012),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2012),"carr1p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2012),"carr2p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2012),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2012),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2012),"carr2p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2012),"carr3p12"]==12)|(inscriptos[which(inscriptos$aniopinsc==2012),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2012),"carr2p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2012),"carr3p12"]==11)|(inscriptos[which(inscriptos$aniopinsc==2012),"carr1p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2012),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2012),"carr3p12"]==12)|(inscriptos[which(inscriptos$aniopinsc==2012),"carr1p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2012),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2012),"carr3p12"]==11),1,0)
inscriptos[which(inscriptos$aniopinsc==2013),"ecocont13"]<-ifelse((inscriptos[which(inscriptos$aniopinsc==2013),"carr1p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2013),"carr2p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2013),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2013),"carr1p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2013),"carr2p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2013),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2013),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2013),"carr2p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2013),"carr3p12"]==12)|(inscriptos[which(inscriptos$aniopinsc==2013),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2013),"carr2p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2013),"carr3p12"]==11)|(inscriptos[which(inscriptos$aniopinsc==2013),"carr1p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2013),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2013),"carr3p12"]==12)|(inscriptos[which(inscriptos$aniopinsc==2013),"carr1p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2013),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2013),"carr3p12"]==11),1,0)
inscriptos[which(inscriptos$aniopinsc==2014),"ecocont14"]<-ifelse((inscriptos[which(inscriptos$aniopinsc==2014),"carr1p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2014),"carr2p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2014),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2014),"carr1p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2014),"carr2p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2014),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2014),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2014),"carr2p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2014),"carr3p12"]==12)|(inscriptos[which(inscriptos$aniopinsc==2014),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2014),"carr2p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2014),"carr3p12"]==11)|(inscriptos[which(inscriptos$aniopinsc==2014),"carr1p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2014),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2014),"carr3p12"]==12)|(inscriptos[which(inscriptos$aniopinsc==2014),"carr1p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2014),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2014),"carr3p12"]==11),1,0)
inscriptos[which(inscriptos$aniopinsc==2015),"ecocont15"]<-ifelse((inscriptos[which(inscriptos$aniopinsc==2015),"carr1p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2015),"carr2p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2015),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2015),"carr1p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2015),"carr2p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2015),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2015),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2015),"carr2p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2015),"carr3p12"]==12)|(inscriptos[which(inscriptos$aniopinsc==2015),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2015),"carr2p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2015),"carr3p12"]==11)|(inscriptos[which(inscriptos$aniopinsc==2015),"carr1p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2015),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2015),"carr3p12"]==12)|(inscriptos[which(inscriptos$aniopinsc==2015),"carr1p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2015),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2015),"carr3p12"]==11),1,0)
inscriptos[which(inscriptos$aniopinsc==2016),"ecocont15"]<-ifelse((inscriptos[which(inscriptos$aniopinsc==2016),"carr1p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2016),"carr2p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2016),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2016),"carr1p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2016),"carr2p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2016),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2016),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2016),"carr2p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2016),"carr3p12"]==12)|(inscriptos[which(inscriptos$aniopinsc==2016),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2016),"carr2p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2016),"carr3p12"]==11)|(inscriptos[which(inscriptos$aniopinsc==2016),"carr1p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2016),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2016),"carr3p12"]==12)|(inscriptos[which(inscriptos$aniopinsc==2016),"carr1p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2016),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2016),"carr3p12"]==11),1,0)

#Economistas administradores
inscriptos[which(inscriptos$aniopinsc==2012),"ecoadm12"]<-ifelse((inscriptos[which(inscriptos$aniopinsc==2012),"carr1p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2012),"carr2p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2012),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2012),"carr1p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2012),"carr2p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2012),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2012),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2012),"carr2p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2012),"carr3p12"]==12)|(inscriptos[which(inscriptos$aniopinsc==2012),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2012),"carr2p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2012),"carr3p12"]==14)|(inscriptos[which(inscriptos$aniopinsc==2012),"carr1p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2012),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2012),"carr3p12"]==12)|(inscriptos[which(inscriptos$aniopinsc==2012),"carr1p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2012),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2012),"carr3p12"]==14),1,0)
inscriptos[which(inscriptos$aniopinsc==2013),"ecoadm13"]<-ifelse((inscriptos[which(inscriptos$aniopinsc==2013),"carr1p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2013),"carr2p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2013),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2013),"carr1p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2013),"carr2p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2013),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2013),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2013),"carr2p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2013),"carr3p12"]==12)|(inscriptos[which(inscriptos$aniopinsc==2013),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2013),"carr2p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2013),"carr3p12"]==14)|(inscriptos[which(inscriptos$aniopinsc==2013),"carr1p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2013),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2013),"carr3p12"]==12)|(inscriptos[which(inscriptos$aniopinsc==2013),"carr1p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2013),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2013),"carr3p12"]==14),1,0)
inscriptos[which(inscriptos$aniopinsc==2014),"ecoadm14"]<-ifelse((inscriptos[which(inscriptos$aniopinsc==2014),"carr1p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2014),"carr2p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2014),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2014),"carr1p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2014),"carr2p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2014),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2014),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2014),"carr2p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2014),"carr3p12"]==12)|(inscriptos[which(inscriptos$aniopinsc==2014),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2014),"carr2p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2014),"carr3p12"]==14)|(inscriptos[which(inscriptos$aniopinsc==2014),"carr1p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2014),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2014),"carr3p12"]==12)|(inscriptos[which(inscriptos$aniopinsc==2014),"carr1p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2014),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2014),"carr3p12"]==14),1,0)
inscriptos[which(inscriptos$aniopinsc==2015),"ecoadm15"]<-ifelse((inscriptos[which(inscriptos$aniopinsc==2015),"carr1p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2015),"carr2p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2015),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2015),"carr1p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2015),"carr2p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2015),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2015),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2015),"carr2p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2015),"carr3p12"]==12)|(inscriptos[which(inscriptos$aniopinsc==2015),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2015),"carr2p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2015),"carr3p12"]==14)|(inscriptos[which(inscriptos$aniopinsc==2015),"carr1p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2015),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2015),"carr3p12"]==12)|(inscriptos[which(inscriptos$aniopinsc==2015),"carr1p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2015),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2015),"carr3p12"]==14),1,0)
inscriptos[which(inscriptos$aniopinsc==2016),"ecoadm15"]<-ifelse((inscriptos[which(inscriptos$aniopinsc==2016),"carr1p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2016),"carr2p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2016),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2016),"carr1p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2016),"carr2p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2016),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2016),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2016),"carr2p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2016),"carr3p12"]==12)|(inscriptos[which(inscriptos$aniopinsc==2016),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2016),"carr2p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2016),"carr3p12"]==14)|(inscriptos[which(inscriptos$aniopinsc==2016),"carr1p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2016),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2016),"carr3p12"]==12)|(inscriptos[which(inscriptos$aniopinsc==2016),"carr1p12"]==12 & inscriptos[which(inscriptos$aniopinsc==2016),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2016),"carr3p12"]==14),1,0)

#Contadores administradores
inscriptos[which(inscriptos$aniopinsc==2012),"contadm12"]<-ifelse((inscriptos[which(inscriptos$aniopinsc==2012),"carr1p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2012),"carr2p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2012),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2012),"carr1p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2012),"carr2p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2012),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2012),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2012),"carr2p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2012),"carr3p12"]==11)|(inscriptos[which(inscriptos$aniopinsc==2012),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2012),"carr2p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2012),"carr3p12"]==14)|(inscriptos[which(inscriptos$aniopinsc==2012),"carr1p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2012),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2012),"carr3p12"]==11)|(inscriptos[which(inscriptos$aniopinsc==2012),"carr1p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2012),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2012),"carr3p12"]==14),1,0)
inscriptos[which(inscriptos$aniopinsc==2013),"contadm13"]<-ifelse((inscriptos[which(inscriptos$aniopinsc==2013),"carr1p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2013),"carr2p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2013),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2013),"carr1p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2013),"carr2p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2013),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2013),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2013),"carr2p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2013),"carr3p12"]==11)|(inscriptos[which(inscriptos$aniopinsc==2013),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2013),"carr2p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2013),"carr3p12"]==14)|(inscriptos[which(inscriptos$aniopinsc==2013),"carr1p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2013),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2013),"carr3p12"]==11)|(inscriptos[which(inscriptos$aniopinsc==2013),"carr1p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2013),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2013),"carr3p12"]==14),1,0)
inscriptos[which(inscriptos$aniopinsc==2014),"contadm14"]<-ifelse((inscriptos[which(inscriptos$aniopinsc==2014),"carr1p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2014),"carr2p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2014),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2014),"carr1p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2014),"carr2p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2014),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2014),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2014),"carr2p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2014),"carr3p12"]==11)|(inscriptos[which(inscriptos$aniopinsc==2014),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2014),"carr2p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2014),"carr3p12"]==14)|(inscriptos[which(inscriptos$aniopinsc==2014),"carr1p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2014),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2014),"carr3p12"]==11)|(inscriptos[which(inscriptos$aniopinsc==2014),"carr1p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2014),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2014),"carr3p12"]==14),1,0)
inscriptos[which(inscriptos$aniopinsc==2015),"contadm15"]<-ifelse((inscriptos[which(inscriptos$aniopinsc==2015),"carr1p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2015),"carr2p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2015),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2015),"carr1p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2015),"carr2p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2015),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2015),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2015),"carr2p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2015),"carr3p12"]==11)|(inscriptos[which(inscriptos$aniopinsc==2015),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2015),"carr2p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2015),"carr3p12"]==14)|(inscriptos[which(inscriptos$aniopinsc==2015),"carr1p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2015),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2015),"carr3p12"]==11)|(inscriptos[which(inscriptos$aniopinsc==2015),"carr1p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2015),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2015),"carr3p12"]==14),1,0)
inscriptos[which(inscriptos$aniopinsc==2016),"contadm15"]<-ifelse((inscriptos[which(inscriptos$aniopinsc==2016),"carr1p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2016),"carr2p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2016),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2016),"carr1p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2016),"carr2p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2016),"carr3p12"]==0)|(inscriptos[which(inscriptos$aniopinsc==2016),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2016),"carr2p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2016),"carr3p12"]==11)|(inscriptos[which(inscriptos$aniopinsc==2016),"carr1p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2016),"carr2p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2016),"carr3p12"]==14)|(inscriptos[which(inscriptos$aniopinsc==2016),"carr1p12"]==14 & inscriptos[which(inscriptos$aniopinsc==2016),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2016),"carr3p12"]==11)|(inscriptos[which(inscriptos$aniopinsc==2016),"carr1p12"]==11 & inscriptos[which(inscriptos$aniopinsc==2016),"carr2p12"]==0 & inscriptos[which(inscriptos$aniopinsc==2016),"carr3p12"]==14),1,0)

#contadores economistas administradores
inscriptos[which(inscriptos$aniopinsc==2012),"todas12"]<-ifelse(inscriptos$ecopuro12[which(inscriptos$aniopinsc==2012)]!=1 & inscriptos$contpuro12[which(inscriptos$aniopinsc==2012)]!=1 & inscriptos$admpuro12[which(inscriptos$aniopinsc==2012)]!=1 & inscriptos$ecocont12[which(inscriptos$aniopinsc==2012)]!=1 & inscriptos$ecoadm12[which(inscriptos$aniopinsc==2012)]!=1 & inscriptos$contadm12[which(inscriptos$aniopinsc==2012)]!=1,1,0)
inscriptos[which(inscriptos$aniopinsc==2013),"todas13"]<-ifelse(inscriptos$ecopuro13[which(inscriptos$aniopinsc==2013)]!=1 & inscriptos$contpuro13[which(inscriptos$aniopinsc==2013)]!=1 & inscriptos$admpuro13[which(inscriptos$aniopinsc==2013)]!=1 & inscriptos$ecocont13[which(inscriptos$aniopinsc==2013)]!=1 & inscriptos$ecoadm13[which(inscriptos$aniopinsc==2013)]!=1 & inscriptos$contadm13[which(inscriptos$aniopinsc==2013)]!=1,1,0)
inscriptos[which(inscriptos$aniopinsc==2014),"todas14"]<-ifelse(inscriptos$ecopuro14[which(inscriptos$aniopinsc==2014)]!=1 & inscriptos$contpuro14[which(inscriptos$aniopinsc==2014)]!=1 & inscriptos$admpuro14[which(inscriptos$aniopinsc==2014)]!=1 & inscriptos$ecocont14[which(inscriptos$aniopinsc==2014)]!=1 & inscriptos$ecoadm14[which(inscriptos$aniopinsc==2014)]!=1 & inscriptos$contadm14[which(inscriptos$aniopinsc==2014)]!=1,1,0)
inscriptos[which(inscriptos$aniopinsc==2015),"todas15"]<-ifelse(inscriptos$ecopuro15[which(inscriptos$aniopinsc==2015)]!=1 & inscriptos$contpuro15[which(inscriptos$aniopinsc==2015)]!=1 & inscriptos$admpuro15[which(inscriptos$aniopinsc==2015)]!=1 & inscriptos$ecocont15[which(inscriptos$aniopinsc==2015)]!=1 & inscriptos$ecoadm15[which(inscriptos$aniopinsc==2015)]!=1 & inscriptos$contadm15[which(inscriptos$aniopinsc==2015)]!=1,1,0)
inscriptos[which(inscriptos$aniopinsc==2016),"todas15"]<-ifelse(inscriptos$ecopuro15[which(inscriptos$aniopinsc==2016)]!=1 & inscriptos$contpuro15[which(inscriptos$aniopinsc==2016)]!=1 & inscriptos$admpuro15[which(inscriptos$aniopinsc==2016)]!=1 & inscriptos$ecocont15[which(inscriptos$aniopinsc==2016)]!=1 & inscriptos$ecoadm15[which(inscriptos$aniopinsc==2016)]!=1 & inscriptos$contadm15[which(inscriptos$aniopinsc==2016)]!=1,1,0)

#Filtrado de bases de actividad segun consulta de g_inscriptos para los nuevos ingresos a facultad desde p12#
gen2012<-read.csv("g_actividades_de_una_gen_2012_conv.csv")
gen2013<-read.csv("g_actividades_de_una_gen_2013_conv.csv")
gen2014<-read.csv("g_actividades_de_una_gen_2014_conv.csv")
gen2015<-read.csv("g_actividades_de_una_gen_2015_conv.csv")
gen2016<-read.csv("g_actividades_de_una_gen_2016_conv.csv")
colnames(inscriptos)[2]<-"ci"
#Cohorte 2012#
gen2012<-join_all(list(gen2012,inscriptos[which(inscriptos$aniopinsc==2012),c("ci","NOMBRE","ecopuro12","contpuro12","admpuro12","ecocont12","ecoadm12","contadm12","todas12")]),by="ci")
gen2012<-gen2012[which(is.na(gen2012$NOMBRE)==F),]
gen2012$anio_act<-round(gen2012$fecha/10000)
#identificador primer aparicion de cedula
gen2012$ident1<-ifelse(duplicated(gen2012$ci)==F,1,0)

#Cohorte 2013#
gen2013<-join_all(list(gen2013,inscriptos[which(inscriptos$aniopinsc==2013),c("ci","NOMBRE","ecopuro13","contpuro13","admpuro13","ecocont13","ecoadm13","contadm13","todas13")]),by="ci")
gen2013<-gen2013[which(is.na(gen2013$NOMBRE)==F),]
gen2013$anio_act<-round(gen2013$fecha/10000)
#identificador primer aparicion de cedula
gen2013$ident1<-ifelse(duplicated(gen2013$ci)==F,1,0)

#Cohorte 2014#
gen2014<-join_all(list(gen2014,inscriptos[which(inscriptos$aniopinsc==2014),c("ci","NOMBRE","ecopuro14","contpuro14","admpuro14","ecocont14","ecoadm14","contadm14","todas14")]),by="ci")
gen2014<-gen2014[which(is.na(gen2014$NOMBRE)==F),]
gen2014$anio_act<-round(gen2014$fecha/10000)
#identificador primer aparicion de cedula
gen2014$ident1<-ifelse(duplicated(gen2014$ci)==F,1,0)

#Cohorte 2015#
gen2015<-join_all(list(gen2015,inscriptos[which(inscriptos$aniopinsc==2015),c("ci","NOMBRE","ecopuro15","contpuro15","admpuro15","ecocont15","ecoadm15","contadm15","todas15")]),by="ci")
gen2015<-gen2015[which(is.na(gen2015$NOMBRE)==F),]
gen2015$anio_act<-round(gen2015$fecha/10000)
#identificador primer aparicion de cedula
gen2015$ident1<-ifelse(duplicated(gen2015$ci)==F,1,0)

#Cohorte 2016#
gen2016<-join_all(list(gen2016,inscriptos[which(inscriptos$aniopinsc==2016),c("ci","NOMBRE","ecopuro15","contpuro15","admpuro15","ecocont15","ecoadm15","contadm15","todas15")]),by="ci")
gen2016<-gen2016[which(is.na(gen2016$NOMBRE)==F),]
gen2016$anio_act<-round(gen2016$fecha/10000)
#identificador primer aparicion de cedula
gen2016$ident1<-ifelse(duplicated(gen2016$ci)==F,1,0)

listadobases<-list(gen2012,gen2013,gen2014,gen2015,gen2016)
save(listadobases,file="C:\\Users\\msilva\\Documents\\Mathias\\Bases\\Bases\\FCEA\\Actividades actualizadas\\Nuevas para actualizar\\cohortes2.RData")
